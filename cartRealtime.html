<!DOCTYPE html>
<html>
  <head>
    <script type="text/javascript" src="js/smoothie.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script type="text/javascript">


var cpuUsage = 0;
/**
 to get data on the service
*/
function getCpuUsage() { 
    //lets set ajax post options
    var options = {

      type    :"get",
		// document.URL = http://127.0.0.1:8080/
      url     : document.URL +"cpu",
      dataType: "json",
    };

    var requestCount = $.ajax(options);

    requestCount.done(function(response) {

     
      //console.log(parseInt(response.Value));
       
      cpuUsage = parseInt(response.Value);

      percentCPU.innerHTML= "CPU(s): " + cpuUsage + "%";      

    });

    requestCount.fail(function() {

    });

    return cpuUsage
}

      // Randomly add a data point every 500ms
      var random = new TimeSeries();
      setInterval(function() {
        random.append(new Date().getTime(), getCpuUsage() );
      }, 500);
      
      function createTimeline() {
        var chart = new SmoothieChart();
        chart.addTimeSeries(random, { strokeStyle: 'rgba(0, 255, 0, 1)', fillStyle: 'rgba(0, 255, 0, 0.2)', lineWidth: 4 });

        chart.streamTo(document.getElementById("chart"), 500);
      }
    </script>
  </head>
  <body onload="createTimeline()">
   
   <h3 id="percentCPU">CPU(s):0%</h3>

    <canvas id="chart" width="400" height="100"></canvas>


  </body>
</html>
